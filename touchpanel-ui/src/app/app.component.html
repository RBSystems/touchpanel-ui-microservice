<!-- screenoff cover -->
<div *ngIf="socket.screenoff" id="screenoff" (click)="socket.screenoff = false">
	*gasp* you shouldn't be seeing me...this is weird. just click anywhere:)	
</div>

<!-- notifications -->
<simple-notifications [options]="notificationOptions" (onDestroy)="notificationDestroy($event)"></simple-notifications>

<!-- developer mode -->
<div *ngIf="dev" id='dev-console'>
	<span *ngFor="let e of events">{{e | json}}<br></span>
</div>

<!-- main body --> <div class='basediv' [class.innerglow]="dtaMaster">
    <!-- power, help -->
    <div class='power-row'>
        <div class='power' (click)="buttonpress('power'); powerOff()" (press)="poweroffmodal.show()">
            <i class='material-icons'>power_settings_new</i>
        </div>
        <div class='help' (click)="buttonpress('help'); helpmodal.show()">
            <i class='material-icons'>help</i>
        </div>
    </div>


	<!-- display-selection -->
	<div *ngIf="multipledisplays" class='main-control-h'>
		<div class='display-selection'>
			<div *ngFor="let d of displays" [class.fadeout]="!displayselection" (click)="goToDisplayControl([d.name])">
				<div class='multi-circle-title'>
					<span>{{d.displayname}}</span>
				</div>
				<div class='multi-circle'>
					<i class='material-icons'>{{d.icon}}</i>
				</div>
			</div>
		</div>
	</div>

    <!-- display control -->
    <div [class.hidden]='displayselection || microphonecontrol' class='main-control-h'>
        <div class='main-control-v' >
			<div class='roomname' [class.roomname-transition]="!selectedDisplay.blanked || true">
				<span *ngIf="!dtaMaster">{{selectedDisplay.displayname}}</span>
				<span *ngIf="dtaMaster">all displays</span>
			</div>
            <div class='circle' [class.circle-shrink]="!selectedDisplay.blanked || true" [class.circle-blanked]="selectedDisplay.blanked" (click)="buttonpress('blank'); toggleBlank();">
				<i *ngIf="!dtaMaster" class='material-icons' [class.icon-blanked]="selectedDisplay.blanked">{{selectedDisplay.icon}}</i>
				<i *ngIf="dtaMaster" class='material-icons' [class.icon-blanked]="selectedDisplay.blanked">subscriptions</i>
				<!-- blanking -->
				<span *ngIf="!selectedDisplay.blanked" class='blank'>picture on</span>
				<span *ngIf="selectedDisplay.blanked" class='blank'>picture off</span>
				<div class='switch-wrapper' (swipeleft)="buttonpress('blank'); setBlank(true)" (swiperight)="buttonpress('blank'); setBlank(false)">
					<label class="switch">
						<input disabled="disabled" [checked]="!selectedDisplay.blanked" type="checkbox">
						<div class="slider round"></div>
					</label>
				</div>
            </div>
            <ul #ring class="ring" [class.ring-grow]="!selectedDisplay.blanked || true">
				<li class="title-slice">
					<div>
					</div>
				</li>
                <li *ngFor="let i of selectedDisplay.oinputs"  class="slice input-slice" [class.blanked-input]="selectedDisplay.blanked && selectedDisplay.oinput === i" [class.selectedInput]="selectedDisplay.oinput === i" (click)="buttonpress('change input'); changeInput(i)" (press)="buttonpress('long press input'); longPressInput(i)">
					<div [style.right]="rightoffset" [style.top]="topoffset" class='input'>
						<i class='material-icons'>{{i.icon}}</i>
						<span>{{i.displayname}}</span>
					</div>
                </li>
            </ul>
        </div>
    </div>

	<!-- bottom left control -->
    <div class='blank-row'>
		<!-- display to all -->
		<div *ngIf="displaytoall && !dtaMinion" class="displaytoall" [class.pulse]="dtaMaster" [class.dtaalignleft]="!multipledisplays && !dtaMaster" [class.dtaalignleftshort]="!multipledisplays && dtaMaster">
			<i class='material-icons' [class.persimmion]="dtaMaster" (click)="toggleDisplayToAll();">call_split</i>
			<span *ngIf="!dtaMaster" (click)="toggleDisplayToAll();">Display All</span>
			<span *ngIf="dtaMaster" (click)="toggleDisplayToAll();">Stop</span>
		</div>
		<!-- all control -->
		<div *ngIf="multipledisplays && false" class="all-control" [class.alignleft]="!displayToAll">
			<i *ngIf="!displayselection" class='material-icons' (click)="goToDisplaySelection()">group_work</i>
			<i *ngIf="displayselection" class='material-icons' (click)="goToDisplayControl(['all'])">album</i>
		</div>
    </div>

	<!-- bottom right control -->
    <div class="audio-row">
		<div *ngIf="mics.length > 0" class="microphone" (click)="micmodal.show()">
			<i class="material-icons">mic</i>
		</div>
		<div *ngIf="!displayselection && !dtaMinion" (click)="buttonpress('mute'); toggleMute()" [class.alignright]="!mics.length > 0">
       	    <i *ngIf="isMuted()" class="material-icons red">volume_off</i>
       	    <i *ngIf="!isMuted()" class="material-icons">volume_up</i>
       	</div>
    </div>

    <!-- sidebar -->
    <div *ngIf="!displayselection && !dtaMinion" class='sidebar'>
        <div class='volume alignright'>
            <md-slider id="colored-slider" vertical [value]="volumeLevel()" (change)="buttonpress('volume slider'); changeVolume($event.value);" (input)="updateVolume($event.value)"></md-slider>
        </div>
    </div>

    <!-- slice of the circle -->
<svg id='svg-block' width="0" height="0">
  <defs>
    <clipPath clipPathUnits="objectBoundingBox" id="sector">
		<path fill="transparent" stroke="#111" stroke-width="1" id="sector" [attr.d]="arcpath"></path>
    </clipPath>
  </defs>
</svg>

<!-- title slice -->
<svg id='svg-block' width="0" height="0">
  <defs>
    <clipPath clipPathUnits="objectBoundingBox" id="title-sector">
		<path fill="transparent" stroke="#111" stroke-width="1" id="sector" [attr.d]="titlearcpath"></path>
    </clipPath>
  </defs>
</svg>

</div>

<div class='overlay basediv' *ngIf="!showing" [@fadeInOut] (click)="buttonpress('power on'); enterScreen()">
    <img class='loading-img' [class.spinner]='!startSpinning' [class.spin_fast]='startSpinning' src='assets/byu_medallion_white.svg'>
</div>

<!-- management dialog -->
<div class="management basediv priority" *ngIf="!showing">
    <div class="top right" (click)="management(1)">
    </div>
    <div class="top left" (click)="management(3)">
    </div>
    <div class="bottom left" (click)="management(2)">
    </div>
    <div *ngIf="!man1 || !man2 || !man3" class="bottom right" (click)="management(4)">
    </div>
    <div *ngIf="man1 && man2 && man3" class="bottom right" (click)="management(4); managementmodal.show();">
    </div>
</div>


<!-- pop-ups -->
<app-modal #micmodal>
    <div class="app-modal-body">
        <div class="modal-body">
			<div class='microphone-selection'>
				<div *ngFor="let mic of mics" class='mic'>
					<div class='mic-title'>
						<span *ngIf="mic.displayname">{{mic.displayname}}</span>
						<span *ngIf="!mic.displayname">{{mic.name}}</span>
					</div>
					<div class='mic-volume'>
		            	<md-slider id="mic.name" vertical [value]="mic.volume" (change)="buttonpress('mic volume slider'); changeMicVolume($event.value, mic.name)"></md-slider>
					</div>
					<div class='mic-mute' (click)="toggleMicMute(mic.name)">
		   	    		<i *ngIf="mic.muted" class="material-icons red">volume_off</i>
		   	    		<i *ngIf="!mic.muted" class="material-icons">volume_up</i>
					</div>
				</div>
			</div>
        </div>
		<!--
        <div class="modal-bottom">
            <button class="btn btn-primary" (click)="micmodal.hide()">Done</button>
        </div>
		-->
    </div>
</app-modal>

<app-modal #helpmodal>
    <div class="app-modal-body">
        <div class="modal-icon">
            <i class='material-icons helpdialog'>info_outline</i>
        </div>
        <div class="modal-title">
            Help
        </div>
        <div class="modal-body">
            <span id="helpwords">Please call AV Support at 801-422-7671 for help, or request help by pressing 'Request Help'</span>
        </div>
        <div class="modal-bottom">
			<button class="btn btn-warning" [disabled]="helprequested" (click)="slackconfirmmodal.show(); help('help')">Request Help</button>
			<!--
			<div class="btnspacing"></div>
			<button class="btn btn-primary" (click)="helpmodal.hide();">Done</button> 
			-->
        </div>
    </div>
</app-modal>

<app-modal #slackconfirmmodal>
    <div class="app-modal-body">
        <div class="modal-icon">
            <i class='material-icons helpdialog'>add_alert</i>
        </div>
        <div class="modal-title">
            Confirm
        </div>
        <div class="modal-body">
            <span id="helpwords">Request recieved! A technician is on their way.</span>
        </div>
        <div class="modal-bottom">
            <button class="btn btn-primary" (click)="help('cancel'); helpmodal.hide(); slackconfirmmodal.hide();">Cancel</button>
			<div class="btnspacing"></div>
			<button class="btn btn-success" (click)="help('confirm'); helpmodal.hide(); slackconfirmmodal.hide();">Confirm</button>
        </div>
    </div>
</app-modal>

<app-modal #managementmodal>
    <div class="app-modal-body">
        <div class="modal-title">
            Management
        </div>
        <div class="modal-body">
            <div class="management-body">
                <div>
                    <button class="btn btn-warning" (click)="refresh()">Refresh</button>
                </div>
                <div>
                    <button class="btn btn-success" (click)="toDashboard()">Dashboard</button>
                </div>
                <div>
                    <button class="btn" [class.btn-success]="dev" [class.btn-danger]="!dev" (click)="dev = !dev">Toggle Dev Mode</button>
                </div>
                <div>
                    <button class="btn btn-info" (click)="deviceinfo(); deviceinfomodal.show()">Device Info</button>
                </div>
                <div>
                    <button class="btn btn-info" (click)="dockerstatus(); dockerstatusmodal.show()">Docker Status</button>
                </div>
                <div>
                    <button class="btn btn-danger" (click)="confirmrebootmodal.show()">Reboot</button>
                </div>
            </div>
        </div>
		<!-- 
        <div class="modal-bottom">
            <button class="btn btn-primary" (click)="managementmodal.hide()">Done</button>
        </div>
		-->
    </div>
</app-modal>

<app-modal #deviceinfomodal>
    <div class="app-modal-body">
        <div class="modal-title">
            Device Info
        </div>
        <div class="modal-body">
            <div class="vert-align">
                <div *ngIf="deviceInfo.hostname">
                    <span>Hostname:</span>
                    <span>{{deviceInfo.hostname}}</span>
                </div>
                <div *ngIf="deviceInfo.ipaddress">
                    <span>IP Address:</span>
                    <span>{{deviceInfo.ipaddress}}</span>
                </div>
            </div>
        </div>
		<!--
        <div class="modal-bottom">
            <button class="btn btn-primary" (click)="deviceinfomodal.hide()">Done</button>
        </div>
		-->
    </div>
</app-modal>

<app-modal #dockerstatusmodal>
    <div class="app-modal-body">
        <div class="modal-title">
            Docker Status
        </div>
        <div class="modal-body">
            <div *ngIf="dockerStatus" style="overflow: hidden;">
                <pre>{{dockerStatus}}</pre>
            </div>
        </div>
		<!--
        <div class="modal-bottom">
            <button class="btn btn-primary" (click)="dockerstatusmodal.hide()">Done</button>
        </div>
		-->
    </div>
</app-modal>

<app-modal #confirmrebootmodal>
    <div class="app-modal-body">
        <div class="modal-icon">
            <i class='material-icons rebootdialog'>info_outline</i>
        </div>
        <div class="modal-title">
            Are you sure?
        </div>
        <div class="modal-body">
        </div>
        <div class="modal-bottom">
            <button class="btn btn-danger" (click)="confirmrebootmodal.hide()">Cancel</button>
			<div class="btnspacing"></div>
            <button class="btn btn-success" (click)="reboot()">Reboot</button>
        </div>
    </div>
</app-modal>

<app-modal #resetviamodal>
    <div class="app-modal-body">
        <div class="modal-icon">
            <i class='material-icons rebootdialog'>info_outline</i>
        </div>
        <div class="modal-title">
			VIA Control
        </div>
        <div class="modal-body">
        </div>
        <div class="modal-bottom">
            <button class="btn btn-danger" (click)="resetviamodal.hide()">Cancel</button>
			<div class="btnspacing"></div>
            <button class="btn btn-warning" (click)="via('reset'); resetviamodal.hide()">Reset</button>
			<div class="btnspacing"></div>
            <button class="btn btn-success" (click)="via('reboot'); resetviamodal.hide()">Reboot</button>
        </div>
    </div>
</app-modal>

<app-modal #poweroffmodal>
    <div class="app-modal-body">
        <div class="modal-title">
			Power off all displays?
        </div>
        <div class="modal-body">
        </div>
        <div class="modal-bottom">
            <button class="btn btn-danger" (click)="poweroffmodal.hide()">Cancel</button>
			<div class="btnspacing"></div>
            <button class="btn btn-success" (click)="powerOffAll(); poweroffmodal.hide();">Confirm</button>
        </div>
    </div>
</app-modal>
