<mat-tab-group #tabs color="accent" class="mat-tab-label-darker" (selectedTabChange)="
    command.buttonPress('changed audio control tab to ' + $event.tab.textLabel)
  ">
    <ng-container *ngIf="preset?.displays?.length > 0">
        <mat-tab label="Displays">
            <!-- master slider -->
            <div class="master">
                <div class="device">
                    <span>Master Volume</span>
                    <i class="material-icons">speaker_group</i>
                    <volume class="volume" [level]="preset?.masterVolume" [mute]="preset?.masterVolume === 0 || preset?.masterMute" (levelChange)="
              command.setMasterVolume($event, preset);
              command.buttonPress('master volume set', {
                level: $event
              })
            " (muteChange)="
              command.setMasterMute($event.muted, preset);
              command.buttonPress(
                'master volume ' + ($event.muted ? 'mute' : 'unmute')
              )
            ">
                    </volume>
                </div>
            </div>

            <div class="devices displays">
                <!-- preset.audioDevices mixLevel sliders -->
                <div *ngFor="let a of preset?.audioDevices" class="device">
                    <span>{{ a.displayname }}</span>
                    <i class="material-icons">{{ a.icon }}</i>
                    <volume class="volume" [level]="a?.mixlevel" [mute]="a?.mixmute" (levelChange)="
              command.setMixLevel($event, a, preset);
              command.setMixMute(false, a, preset);
              command.buttonPress('mix level set', {
                level: $event,
                audioDevices: [a?.name]
              })
            " (muteChange)="
              command.setMixMute($event.muted, a, preset);
              command.buttonPress(
                'mix level ' + ($event.level === 0 ? 'mute' : 'unmute'),
                a?.name
              )
            ">
                    </volume>
                </div>
            </div>
        </mat-tab>
    </ng-container>

    <!-- List of all the extra audio types included. This makes sure the first char is uppercase -->
    <ng-container *ngIf="audioGroups; else noAudioGroups">
        <mat-tab *ngFor="let type of audioTypes" [label]="type?.charAt(0).toUpperCase() + type.slice(1) + 's'">
            <div class="devices">
                <div *ngFor="let a of preset?.audioTypes?.get(type)" class="device">
                    <span>{{ a.displayname }}</span>
                    <i class="material-icons">{{ a.icon }}</i>
                    <volume class="volume" [level]="a?.mixlevel" [mute]="a?.mixmute" (levelChange)="
              command.setMixLevel($event, a);
              command.setMixMute(false, a, preset);
              command.buttonPress('audio type volume set', {
                level: $event,
                audioDevices: [a?.name]
              })
            " (muteChange)="
              command.setMute($event.muted, [a]);
              command.buttonPress(
                'audio type ' + ($event.muted ? 'mute' : 'unmute'),
                a?.name
              )
            ">
                    </volume>
                </div>
            </div>
        </mat-tab>
    </ng-container>

    <ng-template #noAudioGroups>
        <mat-tab label="Devices">
            <div class="devices">
                <div *ngFor="let a of preset?.independentAudioDevices" class="device">
                    <span>{{ a.displayname }}</span>
                    <i class="material-icons">{{ a.icon }}</i>
                    <volume class="volume" [level]="a?.mixlevel" [mute]="a?.mixmute" (levelChange)="
              command.setMixLevel($event, a);
              command.setMixMute(false, a, preset);
              command.buttonPress('independent audio volume set', {
                level: $event,
                audioDevices: [a?.name]
              })
            " (muteChange)="
              command.setMute($event.muted, [a]);
              command.buttonPress(
                'independent audio ' + ($event.muted ? 'mute' : 'unmute'),
                a?.name
              )
            ">
                    </volume>
                </div>
            </div>
        </mat-tab>
    </ng-template>
</mat-tab-group>